#!/bin/bash

# Download Plug
if [ ! -e "$HOME"/.config/nvim/autoload/plug.vim ]; then
  curl -fLo "$HOME"/.config/nvim/autoload/plug.vim --create-dirs \
      https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
fi

# Install the plugins listed in the plugins.vim file
nvim -u "$HOME"/.config/nvim/plugins.vim +PlugInstall +PlugClean! +qa

# Remove the Thoughtbot dotfiles hooks
# https://github.com/thoughtbot/rcm/issues/187
rm -rf $HOME/.thoughtbot_dotfiles/hooks

# Symbolically link the system dictionary to the vim spellfile
mkdir -p $HOME/Library/Spelling
mkdir -p $HOME/.config/nvim/spelling
ln -sf $HOME/Dropbox/Mackup/Spelling/LocalDictionary $HOME/Library/Spelling/LocalDictionary
ln -sf $HOME/Dropbox/Mackup/Spelling/LocalDictionary $HOME/.config/nvim/spelling/en.utf-8.add

# Generate the Vim themes
# TODO: Ensure the base16-builder tool is installed before running the command below.
mkdir -p $HOME/.config/nvim/themes

base16-builder -t vim -s $HOME/.dotfiles/themes/landon.yml -b light \
  > $HOME/.config/nvim/themes/landon.vim
base16-builder -t $HOME/.dotfiles/themes/vim_custom.ejs -s $HOME/.dotfiles/themes/landon.yml \
  -b light > $HOME/.config/nvim/themes/landon_custom.vim
base16-builder -t vim -s tomorrow -b light > $HOME/.config/nvim/themes/tomorrow.vim
base16-builder -t $HOME/.dotfiles/themes/vim_custom.ejs -s tomorrow \
  -b light > $HOME/.config/nvim/themes/tomorrow_custom.vim
