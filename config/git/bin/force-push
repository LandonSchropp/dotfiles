#!/usr/bin/env bash

set -euo pipefail

current_branch=$(git branch --show-current)

# If the current branch contains master or main, prompt the user for confirmation.
if [[ "$current_branch" =~ (master|main) ]]; then
  echo -e "⚠️ You are on the '$current_branch' branch. This branch is typically protected and" \
    "force-pushing can lead to data loss.\n"

  read \
    -r \
    -p \
    "Are you sure you want to do this? [Yes/No] " \
    response

  if [[ ! "$response" =~ ^([yY][eE][sS]|[yY])$ ]]; then
    exit 0
  fi
fi

echo
git push --force-with-lease
